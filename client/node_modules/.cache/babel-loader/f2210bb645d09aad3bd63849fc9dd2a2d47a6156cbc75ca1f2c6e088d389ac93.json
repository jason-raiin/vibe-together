{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jasonhuang/Documents/vibe-together/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jasonhuang/Documents/vibe-together/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/jasonhuang/Documents/vibe-together/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/jasonhuang/Documents/vibe-together/node_modules/@babel/runtime/helpers/esm/createClass.js\";import axios from'axios';import{Buffer}from'buffer';import{CLIENT_ID,CLIENT_SECRET,REDIRECT_URI}from'./constants';export var authString=Buffer.from(\"\".concat(CLIENT_ID,\":\").concat(CLIENT_SECRET)).toString('base64');//TODO: OOP-ify the functions\n//TODO: add functions to retrieve historical user data\n//TODO: implement database retrieval and addition methods\n//TODO: constant list could be expanded\nexport var SpotifyService=/*#__PURE__*/function(){function SpotifyService(){_classCallCheck(this,SpotifyService);this.accessToken='';this.refreshToken='';}_createClass(SpotifyService,[{key:\"getAccessToken\",value:function(){var _getAccessToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(code){var payload,response,tokenType,scope,url,response2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;payload={code:\"\".concat(code),redirect_uri:\"\".concat(REDIRECT_URI),grant_type:'authorization_code'};_context.next=4;return axios.post('https://accounts.spotify.com/api/token',payload,{headers:{Authorization:\"Basic \".concat(authString),'Content-Type':'application/x-www-form-urlencoded'}});case 4:response=_context.sent;this.accessToken=response.data.access_token;tokenType=response.data.token_type;scope=response.data.scope;this.refreshToken=response.data.refresh_token;console.log('accessToken:',this.accessToken);console.log('refreshToken:',this.refreshToken);console.log(scope);url=\"https://api.spotify.com/v1/me/top/artists\";_context.next=15;return axios.get(url,{headers:{Authorization:\"Bearer \".concat(this.accessToken)}});case 15:response2=_context.sent;console.log('User Profile:',response2.data);return _context.abrupt(\"return\",response2);case 20:_context.prev=20;_context.t0=_context[\"catch\"](0);console.error('Failed to get access token:');case 23:case\"end\":return _context.stop();}},_callee,this,[[0,20]]);}));function getAccessToken(_x){return _getAccessToken.apply(this,arguments);}return getAccessToken;}()},{key:\"getUserProfile\",value:function(){var _getUserProfile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var url,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;console.log('accessToken:',this.accessToken);url=\"https://api.spotify.com/v1/me/top/artists\";_context2.next=5;return axios.get(url,{headers:{Authorization:\"Bearer \".concat(this.accessToken)}});case 5:response=_context2.sent;console.log('User Profile:',response.data);return _context2.abrupt(\"return\",response);case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.error('Failed to get user profile:');case 13:case\"end\":return _context2.stop();}},_callee2,this,[[0,10]]);}));function getUserProfile(){return _getUserProfile.apply(this,arguments);}return getUserProfile;}()}]);return SpotifyService;}();","map":{"version":3,"names":["axios","Buffer","CLIENT_ID","CLIENT_SECRET","REDIRECT_URI","authString","from","concat","toString","SpotifyService","_classCallCheck","accessToken","refreshToken","_createClass","key","value","_getAccessToken","_asyncToGenerator","_regeneratorRuntime","mark","_callee","code","payload","response","tokenType","scope","url","response2","wrap","_callee$","_context","prev","next","redirect_uri","grant_type","post","headers","Authorization","sent","data","access_token","token_type","refresh_token","console","log","get","abrupt","t0","error","stop","getAccessToken","_x","apply","arguments","_getUserProfile","_callee2","_callee2$","_context2","getUserProfile"],"sources":["/Users/jasonhuang/Documents/vibe-together/src/spotify/spotify.service.ts"],"sourcesContent":["import axios from 'axios';\nimport { Buffer } from 'buffer';\nimport { CLIENT_ID, CLIENT_SECRET, REDIRECT_URI } from './constants';\nimport { access } from 'fs';\n\nexport const authString = Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\n  'base64',\n);\n\n//TODO: OOP-ify the functions\n//TODO: add functions to retrieve historical user data\n//TODO: implement database retrieval and addition methods\n//TODO: constant list could be expanded\n\nexport class SpotifyService {\n  accessToken = '';\n  refreshToken = '';\n\n  async getAccessToken(code: string) {\n    try {\n      const payload = {\n        code: `${code}`,\n        redirect_uri: `${REDIRECT_URI}`,\n        grant_type: 'authorization_code',\n      };\n      const response = await axios.post(\n        'https://accounts.spotify.com/api/token',\n        payload,\n        {\n          headers: {\n            Authorization: `Basic ${authString}`,\n            'Content-Type': 'application/x-www-form-urlencoded',\n          },\n        },\n      );\n\n      this.accessToken = response.data.access_token;\n      const tokenType = response.data.token_type;\n      const scope = response.data.scope;\n      this.refreshToken = response.data.refresh_token;\n\n      console.log('accessToken:', this.accessToken);\n      console.log('refreshToken:', this.refreshToken);\n      console.log(scope);\n\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response2 = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`,\n        },\n      });\n\n      console.log('User Profile:', response2.data);\n      return response2;\n    } catch (error) {\n      console.error('Failed to get access token:');\n    }\n  }\n\n  async getUserProfile() {\n    try {\n      console.log('accessToken:', this.accessToken);\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`,\n        },\n      });\n\n      console.log('User Profile:', response.data);\n      return response;\n    } catch (error) {\n      console.error('Failed to get user profile:');\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}