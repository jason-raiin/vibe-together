{"ast":null,"code":"import axios from 'axios';\nimport { Buffer } from 'buffer';\nimport { CLIENT_ID, CLIENT_SECRET, REDIRECT_URI } from './constants';\nexport const authString = Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString('base64');\n\n//TODO: OOP-ify the functions\n//TODO: add functions to retrieve historical user data\n//TODO: implement database retrieval and addition methods\n//TODO: constant list could be expanded\n\nexport class SpotifyService {\n  constructor() {\n    this.accessToken = '';\n    this.refreshToken = '';\n  }\n  async getAccessToken(code) {\n    try {\n      const payload = {\n        code: `${code}`,\n        redirect_uri: `${REDIRECT_URI}`,\n        grant_type: 'authorization_code'\n      };\n      const response = await axios.post('https://accounts.spotify.com/api/token', payload, {\n        headers: {\n          Authorization: `Basic ${authString}`,\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      });\n      this.accessToken = response.data.access_token;\n      const tokenType = response.data.token_type;\n      const scope = response.data.scope;\n      this.refreshToken = response.data.refresh_token;\n      console.log('accessToken:', this.accessToken);\n      console.log('refreshToken:', this.refreshToken);\n      console.log(scope);\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response2 = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`\n        }\n      });\n      console.log('User Profile:', response2.data);\n      return response2;\n    } catch (error) {\n      console.error('Failed to get access token:');\n    }\n  }\n  async getUserProfile() {\n    try {\n      console.log('accessToken:', this.accessToken);\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`\n        }\n      });\n      console.log('User Profile:', response.data);\n      return response;\n    } catch (error) {\n      console.error('Failed to get user profile:');\n    }\n  }\n}","map":{"version":3,"names":["axios","Buffer","CLIENT_ID","CLIENT_SECRET","REDIRECT_URI","authString","from","toString","SpotifyService","constructor","accessToken","refreshToken","getAccessToken","code","payload","redirect_uri","grant_type","response","post","headers","Authorization","data","access_token","tokenType","token_type","scope","refresh_token","console","log","url","response2","get","error","getUserProfile"],"sources":["/Users/jasonhuang/Documents/vibe-together/src/spotify/spotify.service.ts"],"sourcesContent":["import axios from 'axios';\nimport { Buffer } from 'buffer';\nimport { CLIENT_ID, CLIENT_SECRET, REDIRECT_URI } from './constants';\n\nexport const authString = Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\n  'base64',\n);\n\n//TODO: OOP-ify the functions\n//TODO: add functions to retrieve historical user data\n//TODO: implement database retrieval and addition methods\n//TODO: constant list could be expanded\n\nexport class SpotifyService {\n  accessToken = '';\n  refreshToken = '';\n\n  async getAccessToken(code: string) {\n    try {\n      const payload = {\n        code: `${code}`,\n        redirect_uri: `${REDIRECT_URI}`,\n        grant_type: 'authorization_code',\n      };\n      const response = await axios.post(\n        'https://accounts.spotify.com/api/token',\n        payload,\n        {\n          headers: {\n            Authorization: `Basic ${authString}`,\n            'Content-Type': 'application/x-www-form-urlencoded',\n          },\n        },\n      );\n\n      this.accessToken = response.data.access_token;\n      const tokenType = response.data.token_type;\n      const scope = response.data.scope;\n      this.refreshToken = response.data.refresh_token;\n\n      console.log('accessToken:', this.accessToken);\n      console.log('refreshToken:', this.refreshToken);\n      console.log(scope);\n\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response2 = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`,\n        },\n      });\n\n      console.log('User Profile:', response2.data);\n      return response2;\n    } catch (error) {\n      console.error('Failed to get access token:');\n    }\n  }\n\n  async getUserProfile() {\n    try {\n      console.log('accessToken:', this.accessToken);\n      const url = `https://api.spotify.com/v1/me/top/artists`;\n      const response = await axios.get(url, {\n        headers: {\n          Authorization: `Bearer ${this.accessToken}`,\n        },\n      });\n\n      console.log('User Profile:', response.data);\n      return response;\n    } catch (error) {\n      console.error('Failed to get user profile:');\n    }\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,SAAS,EAAEC,aAAa,EAAEC,YAAY,QAAQ,aAAa;AAEpE,OAAO,MAAMC,UAAU,GAAGJ,MAAM,CAACK,IAAI,CAAE,GAAEJ,SAAU,IAAGC,aAAc,EAAC,CAAC,CAACI,QAAQ,CAC7E,QACF,CAAC;;AAED;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,cAAc,CAAC;EAAAC,YAAA;IAAA,KAC1BC,WAAW,GAAG,EAAE;IAAA,KAChBC,YAAY,GAAG,EAAE;EAAA;EAEjB,MAAMC,cAAcA,CAACC,IAAY,EAAE;IACjC,IAAI;MACF,MAAMC,OAAO,GAAG;QACdD,IAAI,EAAG,GAAEA,IAAK,EAAC;QACfE,YAAY,EAAG,GAAEX,YAAa,EAAC;QAC/BY,UAAU,EAAE;MACd,CAAC;MACD,MAAMC,QAAQ,GAAG,MAAMjB,KAAK,CAACkB,IAAI,CAC/B,wCAAwC,EACxCJ,OAAO,EACP;QACEK,OAAO,EAAE;UACPC,aAAa,EAAG,SAAQf,UAAW,EAAC;UACpC,cAAc,EAAE;QAClB;MACF,CACF,CAAC;MAED,IAAI,CAACK,WAAW,GAAGO,QAAQ,CAACI,IAAI,CAACC,YAAY;MAC7C,MAAMC,SAAS,GAAGN,QAAQ,CAACI,IAAI,CAACG,UAAU;MAC1C,MAAMC,KAAK,GAAGR,QAAQ,CAACI,IAAI,CAACI,KAAK;MACjC,IAAI,CAACd,YAAY,GAAGM,QAAQ,CAACI,IAAI,CAACK,aAAa;MAE/CC,OAAO,CAACC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAClB,WAAW,CAAC;MAC7CiB,OAAO,CAACC,GAAG,CAAC,eAAe,EAAE,IAAI,CAACjB,YAAY,CAAC;MAC/CgB,OAAO,CAACC,GAAG,CAACH,KAAK,CAAC;MAElB,MAAMI,GAAG,GAAI,2CAA0C;MACvD,MAAMC,SAAS,GAAG,MAAM9B,KAAK,CAAC+B,GAAG,CAACF,GAAG,EAAE;QACrCV,OAAO,EAAE;UACPC,aAAa,EAAG,UAAS,IAAI,CAACV,WAAY;QAC5C;MACF,CAAC,CAAC;MAEFiB,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEE,SAAS,CAACT,IAAI,CAAC;MAC5C,OAAOS,SAAS;IAClB,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdL,OAAO,CAACK,KAAK,CAAC,6BAA6B,CAAC;IAC9C;EACF;EAEA,MAAMC,cAAcA,CAAA,EAAG;IACrB,IAAI;MACFN,OAAO,CAACC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAClB,WAAW,CAAC;MAC7C,MAAMmB,GAAG,GAAI,2CAA0C;MACvD,MAAMZ,QAAQ,GAAG,MAAMjB,KAAK,CAAC+B,GAAG,CAACF,GAAG,EAAE;QACpCV,OAAO,EAAE;UACPC,aAAa,EAAG,UAAS,IAAI,CAACV,WAAY;QAC5C;MACF,CAAC,CAAC;MAEFiB,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEX,QAAQ,CAACI,IAAI,CAAC;MAC3C,OAAOJ,QAAQ;IACjB,CAAC,CAAC,OAAOe,KAAK,EAAE;MACdL,OAAO,CAACK,KAAK,CAAC,6BAA6B,CAAC;IAC9C;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}